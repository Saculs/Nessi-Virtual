<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Nessi Nezzila</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link type="text/css" rel="stylesheet" href="examples/main.css">

		<link rel='shortcut icon' href='favicon.ico' type='image/png' />
  		<link rel="icon" sizes="192x192" href="favicon.ico">
		<link rel="manifest" href="mani.webmanifest"/>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		
		<link rel="stylesheet" type="text/css" href="loading-bar.css"/>
<script type="text/javascript" src="loading-bar.js"></script>




<style type="text/css">

	html{
		touch-action: none;
	}

	.ldBar path.mainline {
	  stroke-width: 10; 
	  stroke:  #f1f2f3;
	}
	.ldBar path.baseline {
	  stroke-width: 18;
	  stroke: #272727;
	}

	#myProgress {
  width: 40%;
  background-color: black;
  outline-style: outset;
  outline-width:1px;
  outline-color:white;
  padding: 2px;
  position: absolute;
  bottom: 30%;
  left:30%;
}

#myBar {
  width: 1%;
  height: 20px;
  background-color: white;
}

  </style>


	</head>
	<body>

		<div id="blocker">
			
			<div id="instructions">
				<div>
				<span id='loadText' style="font-size:36px">Loading...</br></span>
				</div>
				<div id="myProgress">
					<div id="myBar"></div>
				</div>
				<!--
				<br /><br />
				Move: ARROWS / WASD<br/>
				Look: MOUSE
			-->
			</div>

		</div>

		

		<script type="module">

(function(){var script=document.createElement('script');script.onload=function(){var stats=new Stats();document.body.appendChild(stats.dom);requestAnimationFrame(function loop(){stats.update();requestAnimationFrame(loop)});};script.src='//mrdoob.github.io/stats.js/build/stats.min.js';document.head.appendChild(script);})()

			import * as THREE from './build/three.module.js';

			import { PointerLockControls } from './examples/jsm/controls/PointerLockControls.js';
			import { GLTFLoader } from './examples/jsm/loaders/GLTFLoader.js';

			import { FireShader } from './FireShader.js';

			import {
				Euler,
				EventDispatcher,
				Vector3
			} from "./build/three.module.js";


			var loader = new GLTFLoader();

			var camera, scene, scene1, scene2, scene3,renderer, controls;

			var currentScene;

			var ufo;
			  
			var scene0loaded=false;

			var scene1loaded = false;

			var scene2loaded = true;

			var scene3loaded = false;

			var objects = [];

			var raycaster;

			var clock;
			var fire;

			var moveForward = false;
			var moveBackward = false;
			var moveLeft = false;
			var moveRight = false;
			var canJump = false;

			var prevTime = performance.now();
			var velocity = new THREE.Vector3();
			var direction = new THREE.Vector3();
			var vertex = new THREE.Vector3();
			var color = new THREE.Color();

			var manager = new THREE.LoadingManager();

manager.onProgress = function (item, loaded, total) {
    console.log(item, loaded, total);
};
manager.onLoad = function () {
    console.log('all items loaded');
};
manager.onError = function () {
    console.log('there has been an error');
};

var elem = document.getElementById("myBar");
var loading = document.getElementById("myProgress");

var Fire = function ( fireTex, color ) {

var fireMaterial = new THREE.ShaderMaterial( {
	defines         : FireShader.defines,
	uniforms        : THREE.UniformsUtils.clone( FireShader.uniforms ),
	vertexShader    : FireShader.vertexShader,
	fragmentShader  : FireShader.fragmentShader,
	transparent     : true,
	depthWrite      : false,
	depthTest       : true
} );

// initialize uniforms 

fireTex.magFilter = fireTex.minFilter = THREE.LinearFilter;
fireTex.wrapS = fireTex.wrapT = THREE.ClampToEdgeWrapping;

fireMaterial.uniforms.fireTex.value = fireTex;
fireMaterial.uniforms.color.value = color || new THREE.Color( 0xeeeeee );
fireMaterial.uniforms.invModelMatrix.value = new THREE.Matrix4();
fireMaterial.uniforms.scale.value = new THREE.Vector3( 1, 1, 1 );
fireMaterial.uniforms.seed.value = Math.random() * 19.19;
fireMaterial.uniforms.magnitude.value = 2.6;


THREE.Mesh.call( this, new THREE.BoxGeometry( 1.0, 1.0, 1.0 ), fireMaterial );
};

Fire.prototype = Object.create( THREE.Mesh.prototype );
Fire.prototype.constructor = THREE.Fire;

Fire.prototype.update = function ( time ) {

var invModelMatrix = this.material.uniforms.invModelMatrix.value;

this.updateMatrixWorld();
invModelMatrix.getInverse( this.matrixWorld );

if( time !== undefined ) {
	this.material.uniforms.time.value = time;
}

this.material.uniforms.invModelMatrix.value = invModelMatrix;

this.material.uniforms.scale.value = this.scale;
};

	init();
	animate();

	function initFire() {


}

	function getRadian(x) {
		return (Math.PI*x)/180;
	}

	function initEnv(){
		var geometry = new THREE.BoxGeometry( 1400, 200, 2 );
		var material = new THREE.MeshLambertMaterial( {color: 0x111111} );
		var cube = new THREE.Mesh( geometry, material );
		cube.position.set(100, 20, -103);
		//scene.add(cube);

		var light = new THREE.PointLight( 0xFFFFFF, 1, 200 );
		light.position.set(- 0, 35, 80);
		scene.add( light );
	}

			function initUfo(){
			
				 var intloader = new GLTFLoader(manager);
				 intloader.load( "models/interior7.glb", function(gltf){
	var int = gltf.scene;

	int.scale.set(15,15,15);

    int.position.set(- 0, 0.50, 60);
	int.rotation.y = getRadian(-90);

    int.visible = true;

    int.traverse(function (o) {
      if (o.isMesh) {
	  console.log("interrior");
      }
    });
    scene.add(int);
	$("#loadText").html(  'loaded<br><br> click to ENTER');
  },
	// called while loading is progressing
	function ( xhr ) {
		var prc =  Math.floor( xhr.loaded / 25107276 * 100 );
		console.log( 'interior ' + xhr +' loaded' );
		$("#loadText").html( prc + '% loading<br>');
		updateLoadBar(prc);
	}
	);

}

function updateLoadBar(prc){
	elem.style.width = prc + "%";
	/*
	if (prc == 100) loading.style.display = 'none';
	else loading.style.display = 'block';
	*/
}


			function goToScene(txt){
	console.log("go To Scene" + txt);
	camera.position.y = 10;
	camera.position.z = 30;
	var euler = new Euler( 0, 0, 0, 'YXZ' );
	camera.quaternion.setFromEuler( euler );
	var index = 2;
	switch(txt) {
  case "Space":
  index = 2;
  if(scene2loaded == false) initScene2();
	currentScene = scene2;
    break;
  case "Fire":
  index = 1;
  if(scene1loaded == false) initScene1();
	currentScene = scene1;
    break;
  case "UFO":
  if(scene0loaded == false)initScene0();
  index = 2;
  currentScene = scene;
  break;
case "AtomGas":
  index = 3;
  if(scene3loaded == false) initScene3();
	currentScene = scene3;
    break;
  default:
	switchScenes();
}

currentScene.add(controls.getObject());

}

			function switchScenes(){
				camera.position.y = 10;
				camera.position.z = 30;
console.log("switch scenes");
if(currentScene == scene) {
	if(scene1loaded == false) initScene1();
	currentScene = scene1;
} else if(currentScene == scene1){
	if(scene2loaded == false) initScene2();
	currentScene = scene2;
}
else if(currentScene == scene2){
	if(scene3loaded == false) initScene3();
	currentScene = scene3;
}
else{currentScene = scene;}
			}

			function initScene0(){
				initUfo();
			}

			function initScene1(){
				scene1.add(controls.getObject());
				scene1loaded = true;

				var amblight = new THREE.AmbientLight( 0x02FD01,0.05);
				scene1.add(amblight);

				var light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 );
				light.position.set( 0.5, 1, 0.75 );
				scene1.add( light );

				var light2 = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 0.75 );
				light2.position.set(-100, 25, -250);
				//scene1.add( light2 );

				var floorGeometry = new THREE.PlaneBufferGeometry( 2000, 2000, 100, 100 );
				floorGeometry.rotateX( - Math.PI / 2 );
				var floorMaterial = new THREE.MeshLambertMaterial( { side: THREE.DoubleSide, color: 0x000000} );

				var floor = new THREE.Mesh( floorGeometry, floorMaterial );

				//scene1.add(floor);

				var light = new THREE.PointLight( 0xFFFFFF, 2, 300 );
				light.position.set(- 0, 35, 80);
				scene1.add( light );

				

			


var somaloader = new GLTFLoader(manager);
somaloader.load( "models/somaTierenRetopoJPG.glb", function(gltf){
	var soma = gltf.scene;

	soma.scale.set(0.3,0.3,0.3);

    //soma.position.set(- 160, 6, 80);
	soma.rotation.y = getRadian(-90);

	soma.visible = true;
	soma.position.set(0,0,20);
	


    soma.traverse(function (o) {
      if (o.isMesh) {
	  console.log("soma");
      }
    });
    scene1.add(soma);
	$("#loadText").html(  'loaded<br><br> click to ENTER');
  },
	// called while loading is progressing
	function ( xhr ) {
		console.log( 'soma ' + ( xhr.loaded) + 'loaded' );
		var prc = Math.floor( xhr.loaded / 4372972 * 100 );
		$("#loadText").html( prc + '% loading<br>');
		updateLoadBar(prc);
	}
	);

	var bildloader = new GLTFLoader(manager);
bildloader.load( "models/FireBilds1.glb", function(gltf){
	var bild = gltf.scene;

	bild.scale.set(0.3,0.3,0.3);
    //bild.position.set(- 40, -1.5, 50);

	bild.rotation.y = getRadian(-90);

	bild.visible = true;

    bild.traverse(function (o) {
      if (o.isMesh) {
	  console.log("bild");
      }
    });
    scene1.add(bild);
	$("#loadText").html(  'loaded<br><br> click to ENTER');
  },
	// called while loading is progressing
	function ( xhr ) {
		console.log( 'bild ' + ( xhr.loaded) + '% loaded' );
		var prc = Math.floor( xhr.loaded / 18102840 * 100 );
		$("#loadText").html( prc + '% loading<br>');
	}
	);


	var Debrisloader = new GLTFLoader(manager);
Debrisloader.load( "models/Debris.glb", function(gltf){
	var Debris = gltf.scene;

	Debris.scale.set(20,20,20);

    Debris.position.set(-10, 0 ,40);
	Debris.rotation.y = getRadian(-90);

    Debris.visible = true;



    Debris.traverse(function (o) {
      if (o.isMesh) {
	  console.log("Debris");
      }
    });
    scene1.add(Debris);
	$("#loadText").html(  'loaded<br>');
  },
	// called while loading is progressing
	function ( xhr ) {
		console.log( 'debris ' + ( xhr.loaded ) + ' loaded' );
		var prc = Math.floor( xhr.loaded / 32162816 * 100 );
		
	}
	);


				var ufoloader = new GLTFLoader(manager);
     ufoloader.load( "models/SpaceshipJPG3.glb", function(gltf){
	var ufo = gltf.scene;

	  ufo.scale.set(45,45,45);

	  ufo.position.set(-100, 20, -250);
	ufo.rotation.y = getRadian(-80);
	ufo.rotation.x = getRadian(10);


    ufo.visible = true;



    ufo.traverse(function (o) {
      if (o.isMesh) {
	  console.log("UFO");
	  if(o.name == 'Emmisive'){
		//o.material.set(new THREE.MeshLambertMaterial( { color: 0xbbbbbb} ));
	  }
      }
    });
    scene1.add(ufo);
  },
	// called while loading is progressing
	function ( xhr ) {

		//console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' );

	}
	);

}

			function initScene2(){

scene2loaded = true;
scene2.add(controls.getObject());

var light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 1);
light.position.set( 0.5, 1, 0.75 );
scene2.add( light );

var light1 = new THREE.PointLight( 0xFFFFFF, 60, 100 );
light1.position.set(- 0, 35, 80);
//scene2.add( light1 );

var amblight = new THREE.AmbientLight( 0xFFFFFF,0.1);
scene2.add(amblight);

//scene2.add(ufo);

var rocksloader = new GLTFLoader(manager);
     rocksloader.load( "models/betonSpace1024.glb", function(gltf){
	var rocks = gltf.scene;

	//rocks.scale.set(0.05,0.05,0.05);

    rocks.position.set(0, 10, -250);
	rocks.rotation.y = getRadian(-80);
	rocks.rotation.x = getRadian(10);

    rocks.visible = true;

    rocks.traverse(function (o) {
      if (o.isMesh) {
	  console.log("rocks " + o.name);
	  if(o.name == 'Sphere001'){
		o.scale.set(50,50,50);
		o.position.set(80, -60, -30);
	  } else if(o.name == 'Sphere') {
		o.scale.set(600,600,600);
	  }
	  else if(o.name.includes("Beton") ) {
		  switch(o.name) {
			case 'Beton_1':
			o.position.set(200, 0, 100);
				break;
			case 'Beton_2':
			o.position.set(200, 0, -100);
				break;
				case 'Beton_3':
			o.position.set(230, -80, 0);
				break;
				case 'Beton_4':
			o.position.set(-200, 0, 100);
				break;
				case 'Beton_5':
			o.position.set(100, 0, -100);
				break;
		  }
		
		o.scale.set(0.2,0.2,0.2);
	  }
	  }
    });
	scene2.add(rocks);
	console.log( 'rocks added to scene' );
	$("#loadText").html(  'loaded<br><br> click to ENTER');
  },
	// called while loading is progressing
	function ( xhr ) {
		console.log( 'rocks ' + ( xhr.loaded ) + ' loaded' );
		var prc = Math.floor( xhr.loaded / 6521912 * 100 );
		$("#loadText").html( prc + '% loading<br>');
		updateLoadBar(prc);
	}
	);

var ufoloader = new GLTFLoader(manager);
     ufoloader.load( "models/SpaceshipJPG3.glb", function(gltf){
	var ufo = gltf.scene;

	  ufo.scale.set(30,30,30);

    ufo.position.set(-50, 20, -250);
	ufo.rotation.y = getRadian(-80);
	ufo.rotation.x = getRadian(-10);

    ufo.visible = true;

    ufo.traverse(function (o) {
      if (o.isMesh) {
	  console.log("UFO");
      }
    });
	scene2.add(ufo);
	console.log( 'ufo added to scene' );
	$("#loadText").html(  'loaded<br>');
  },
	// called while loading is progressing
	function ( xhr ) {
		console.log( 'ufo ' + ( xhr.loaded ) + ' loaded' );
		var prc = Math.floor( xhr.loaded / 2561968 * 100 );
		$("#loadText").html( prc + '% loading<br>');
	}
	);

/*

var uniforms = {  
texture: { type: 't', value: THREE.ImageUtils.loadTexture('textures/Nebula.png') }
};

var material = new THREE.ShaderMaterial( {  
uniforms:       uniforms,
vertexShader:   document.getElementById('sky-vertex').textContent,
fragmentShader: document.getElementById('sky-fragment').textContent
});
*/
var material = new THREE.MeshBasicMaterial();
material.map = new THREE.TextureLoader().load("textures/Nebula.png");
material.color = new THREE.Color( 0xFFFFFF );
material.side = THREE.BackSide;
var sky = new THREE.Mesh(new THREE.SphereGeometry(700, 60, 40), material);
sky.rotation.y = getRadian(100);
//scene2.add(sky); 

}

			function initScene3(){

scene3loaded = true;
scene3.add(controls.getObject());



var amblight = new THREE.AmbientLight( 0x02FD01,0.1); // soft white light
scene3.add( amblight );

var light2 = new THREE.PointLight( 0xFFFFFF, 3, 1600 );
light2.position.set(0.5, 10, 3);
light2.castShadow = true;
scene3.add( light2 );

var light3 = new THREE.PointLight( 0xFFFFFF, 1, 1600 );
light3.position.set(-80, 10, 200);
light3.castShadow = true;
scene3.add( light3 );

var moonloader = new GLTFLoader(manager);
moonloader.load( "models/moon9.glb", function(gltf){
	var moon = gltf.scene;

	moon.scale.set(1,1,1);

    //moon.position.set(- 160, 6, 80);
	moon.rotation.y = getRadian(-90);

    moon.visible = true;



    moon.traverse(function (o) {
      if (o.isMesh) {
	  console.log("moon");
	  o.receiveShadow = true;
      }
    });
    scene3.add(moon);
	$("#loadText").html(  'loaded<br><br> click to ENTER');
  },
	// called while loading is progressing
	function ( xhr ) {
		console.log( 'moon ' + ( xhr.loaded) + '% loaded' );
		var prc = Math.floor( xhr.loaded / 3027156 * 100 );
		$("#loadText").html(  prc + '% loading<br>');
		updateLoadBar(prc);
	}
	);

	var  doorloader = new GLTFLoader(manager);
doorloader.load( "models/DoorRetopo.glb", function(gltf){
	var door = gltf.scene;

	door.scale.set(5,5,5);

    door.position.set(-30, 0, 0);
	door.rotation.y = getRadian(-45);

    door.visible = true;

	

    door.traverse(function (o) {
      if (o.isMesh) {
	  console.log("door");
	  o.castShadow = true;
      }
    });
    scene3.add(door);
	$("#loadText").html(  'loaded<br><br> click to ENTER');
  },
	// called while loading is progressing
	function ( xhr ) {
		console.log( 'door ' + ( xhr.loaded) + '% loaded' );
		var prc = Math.floor( xhr.loaded / 3027156 * 100 );
		$("#loadText").html( prc + '% loading<br>');
	}
	);

	var  Statueloader = new GLTFLoader(manager);
Statueloader.load( "models/Statue1Test.glb", function(gltf){
	var Statue = gltf.scene;

	Statue.scale.set(8,8,8);

    Statue.position.set(15, 0, 0);
	Statue.rotation.y = getRadian(140);

    Statue.visible = true;



    Statue.traverse(function (o) {
      if (o.isMesh) {
	  console.log("Statue");
      }
    });
    scene3.add(Statue);
	$("#loadText").html(  'loaded<br><br> click to ENTER');
  },
	// called while loading is progressing
	function ( xhr ) {
		console.log( 'Statue ' + ( xhr.loaded) + '% loaded' );
		var prc = Math.floor( xhr.loaded / 3027156 * 100 );
		$("#loadText").html( prc + '% loading<br>');
	}
	);




/*

var uniforms = {  
texture: { type: 't', value: THREE.ImageUtils.loadTexture('textures/Nebula.png') }
};

var material = new THREE.ShaderMaterial( {  
uniforms:       uniforms,
vertexShader:   document.getElementById('sky-vertex').textContent,
fragmentShader: document.getElementById('sky-fragment').textContent
});
*/
var material = new THREE.MeshBasicMaterial();
material.map = new THREE.TextureLoader().load("textures/Aurora3.png");
material.color = new THREE.Color( 0xFFFFFF );
material.side = THREE.BackSide;

scene3.add(new THREE.Mesh(new THREE.SphereGeometry(260, 60, 40), material) ); 

}

			function init() {
				 //clock = new THREE.Clock();
				camera = new THREE.PerspectiveCamera( 60, window.innerWidth / window.innerHeight, 1, 1500 );
				camera.position.y = 10;
				camera.position.z = 30;
				scene = new THREE.Scene();
				
				scene1 = new THREE.Scene();
				scene2 = new THREE.Scene();
				scene3 = new THREE.Scene();

				currentScene = scene2;

				//ufo = new THREE.Object3D();
				scene.background = new THREE.Color( 0x000000 );
				//scene1.background = new THREE.Color( 0x000000 );
				//scene.fog = new THREE.Fog( 0xffffff, 0, 750 );
				scene1.fog = new THREE.Fog( 0xffffff, 0, 2000 );
				scene3.fog = new THREE.Fog( 0x02FD01, 0, 900 );

				var light = new THREE.HemisphereLight( 0xeeeeff, 0x777788, 2 );
				light.position.set( 0.5, 3, 0.75 );
				scene.add( light );

				

				controls = new PointerLockControls( camera, document.body );

				var blocker = document.getElementById( 'blocker' );
				var instructions = document.getElementById( 'instructions' );
				/*
				var footer = document.getElementById( 'footer' );
				
				footer.addEventListener( 'click', switchScenes, false );
*/

				$('#footer a').click(function(e) {
 					var txt = $(e.target).text();
  					console.log(txt);
					goToScene(txt);
					blocker.style.display = 'block';
					instructions.style.display = 'block';
					//controls.unlock();					
				});


				instructions.addEventListener( 'click', function () {

					controls.lock();

				}, false );

				document.body.addEventListener( 'touchstart', function () {

					controls.lock();
					console.log("touchstart");
					instructions.style.display = 'none';
					blocker.style.display = 'none';
				}, false );


				controls.addEventListener( 'lock', function () {

					instructions.style.display = 'none';
					blocker.style.display = 'none';

				} );

				controls.addEventListener( 'unlock', function () {

					blocker.style.display = 'block';
					instructions.style.display = '';

				} );

				scene.add( controls.getObject() );

				var onKeyDown = function ( event ) {

					switch ( event.keyCode ) {

						case 38: // up
						case 87: // w
							moveForward = true;
							break;

						case 37: // left
						case 65: // a
							moveLeft = true;
							break;

						case 40: // down
						case 83: // s
							moveBackward = true;
							break;

						case 39: // right
						case 68: // d
							moveRight = true;
							break;

						case 32: // space
							if ( canJump === true ) velocity.y += 250;
							canJump = false;
							break;

					}

				};

				var onKeyUp = function ( event ) {

					switch ( event.keyCode ) {

						case 38: // up
						case 87: // w
							moveForward = false;
							break;

						case 37: // left
						case 65: // a
							moveLeft = false;
							break;

						case 40: // down
						case 83: // s
							moveBackward = false;
							break;

						case 39: // right
						case 68: // d
							moveRight = false;
							break;

					}

				};

				document.addEventListener( 'keydown', onKeyDown, false );
				document.addEventListener( 'keyup', onKeyUp, false );

				raycaster = new THREE.Raycaster( new THREE.Vector3(), new THREE.Vector3( 0, - 1, 0 ), 0, 10 );

				//initPaintings();
				//initEnv();

				initScene2();

				var fireTex = new THREE.TextureLoader().load("./Fire.png");
				fire = new Fire(fireTex);
				fire.scale.set(25,25,25);
				fire.position.set(0,10,-30);
				scene1.add(fire);


				renderer = new THREE.WebGLRenderer( { antialias: true } );
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( window.innerWidth, window.innerHeight );

				//renderer.toneMapping = THREE.ReinhardToneMapping;
				//renderer.toneMappingExposure = 2.3;

				renderer.shadowMap.enabled = true;
				renderer.shadowMap.type = THREE.BasicShadowMap;
				//renderer.gammaOutput = true;
				//renderer.gammaFactor = 2.2;

				document.body.appendChild( renderer.domElement );


				window.addEventListener( 'resize', onWindowResize, false );
			}

			function onWindowResize() {
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight );
			}
			
			var t = 0;

			function animate() {

				requestAnimationFrame( animate );
				t = t + 0.01;
                fire.update(t);


				if ( controls.isLocked === true ) {

					raycaster.ray.origin.copy( controls.getObject().position );
					raycaster.ray.origin.y -= 10;

					var intersections = raycaster.intersectObjects( objects );

					var onObject = intersections.length > 0;

					var time = performance.now();
					var delta = ( time - prevTime ) / 1000;

					velocity.x -= velocity.x * 10.0 * delta;
					velocity.z -= velocity.z * 10.0 * delta;

					velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass

					direction.z = Number( moveForward ) - Number( moveBackward );
					direction.x = Number( moveRight ) - Number( moveLeft );
					direction.normalize(); // this ensures consistent movements in all directions

					if ( moveForward || moveBackward ) velocity.z -= direction.z * 400.0 * delta;
					if ( moveLeft || moveRight ) velocity.x -= direction.x * 400.0 * delta;

					if ( onObject === true ) {

						velocity.y = Math.max( 0, velocity.y );
						canJump = true;

					}

					controls.moveRight( - velocity.x * delta );
					controls.moveForward( - velocity.z * delta );

					controls.getObject().position.y += ( velocity.y * delta ); // new behavior

					if ( controls.getObject().position.y < 10 ) {

						velocity.y = 0;
						controls.getObject().position.y = 10;

						canJump = true;

					}

					prevTime = time;

				}

				renderer.render( currentScene, camera );

			}

		</script>




<div id="footer">

	<a>Space</a> <a>Fire</a> <a>UFO</a> <a>AtomGas</a>

</div>

	</body>
</html>
